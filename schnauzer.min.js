/**! @license schnauzer v1.0.00; Copyright (C) 2017-2018 by Peter Dematté */
!function(t,e){"object"==typeof exports?module.exports=e(t):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return e(t)}):t.Schnauzer=e(t)}(this,function(t,w,v){"use strict";var e=function(t,e){this.version="1.0.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{},partials:{},recursion:"self",characters:'$"<>%-=@',splitter:"|##|"},r(this,e||{},t)},r=function(t,e,r){for(var n in e)t.options[n]=e[n];for(var i in v=1,e=t.options,t.entityRegExp=function(t,e){for(var r in t)e+=r;return new RegExp("["+e+"]","g")}(e.entityMap,[]),t.stopRegExp=new RegExp(/^°+/),s(t,e.tags),t.partials={},e.partials)t.registerPartial(i,e.partials[i]);r&&t.registerPartial(e.recursion,r)};return e.prototype={render:function(t,e){return this.partials[this.options.recursion](t,e)},parse:function(t){return this.partials[this.options.recursion]||this.registerPartial(this.options.recursion,t)},registerHelper:function(t,e){this.options.helpers[t]=e},unregisterHelper:function(t){delete this.options.helpers[t]},registerPartial:function(t,e){return this.partials[t]=function u(l,t){var c=l.options,f=[],s=[],h=[],g=-1,x="",e=t.replace(l.sectionRegExp,function(t,e,r,n,i,s,a){var p=s+e+r,o=i.lastIndexOf(p);return h.length?t:(g++,-1!==o?(h.push(g--),x=Array(++v).join("°"),p+n+a+i.substring(0,o)+s+e+x+r+i.substring(o+p.length)+s+"/"+x+r+a):(r=r.replace(l.stopRegExp,""),f.push(l.partRegExp.test(i)?R(l,u(l,i),r,n,"^"===e):R(l,d(l,i),r,n,"^"===e)),c.splitter))}).split(c.splitter);for(var r=0,n=h.length;r<n;r++)e[h[r]]=u(l,e[h[r]]);for(var r=0,n=e.length;r<n;r++)s.push(E(e[r])?e[r]:d(l,e[r])),f[r]&&s.push(f[r]);return function(t,e){t.__schnauzer&&!e||(t=b(t,e));for(var r=0,n=s.length,i="";r<n;r++)i+=s[r](t)||"";return i}}(this,e)},unregisterPartial:function(t){delete this.options.partials[t]},setTags:function(t){s(this,t)}},e;function s(t,e){var r=t.options.tags="{{"===e[0]?["{{2,3}","}{2,3}"]:e,n=t.options.characters;t.variableRegExp=new RegExp("("+r[0]+")([>!&=]\\s*)*([\\w\\"+n+"\\.\\s*]+)*"+r[1],"g"),t.sectionRegExp=new RegExp(r[0]+"(#|\\^)([\\w"+n+"]*)\\s*(.*?)"+r[1]+"([\\S\\s]*?)("+r[0]+")\\/\\2("+r[1]+")","g"),t.partRegExp=new RegExp(r[0]+"[#^]"),t.escapeRegExp=new RegExp(r[0])}function E(t){return t&&"function"==typeof t}function b(t,e,r,n){return{data:r||t.data||t,extra:e&&[e]||t.extra||[],path:[].concat(t.path!==w?t.path:t,r||[]),helpers:n||{},__schnauzer:!0}}function u(t,e){for(var r=0,n=e.length;r<n;r++)t=t&&t[e[r]];return t}function P(t,e,r,n){var i=[],s=-1===n?0:t.path.length-1-n,a=t.path[s]||{},p=t.helpers[e]!==w?t.helpers[e]:a[e]!==w?a[e]:u(a,i=r||e.split(/[\.\/]/));if(p!==w)return p;for(var o=t.extra.length;o--;){if(t.extra[o][e]!==w)return t.extra[o][e];if((p=u(t.extra[o],i))!==w)return p}}function c(t,e){return String(t).replace(e.entityRegExp,function(t){return e.options.entityMap[t]})}function S(e,r,t){return{getData:function(t){return t=t.split("../"),P(r,t.pop(),w,t.length||-1)},escapeHtml:function(t){return c(t,e)}}}function d(d,l){var R=[],y=d.options;return l=l.replace(d.variableRegExp,function(t,e,r,n){var i,s=r&&("!"===r[0]||"="===r[0]),a=!y.doEscape||d.escapeRegExp.test(e)&&3===e.length||r&&"&"===r[0],p=r&&">"===r[0],o="",u=[],l=!1,c={},f=[],h="",g=!1,x=0;if(s)return"";if(o=(n=n.replace(/^(?:\.|this)\//,function(){return l=!0,""}).split(/\s+/)).shift(),p)for(var v=n.length,E=[];v--;)x=0,(g='"'===(h=(E=n[v].split("="))[1]||E[0])[0]||"'"===h[0])?h=h.replace(/(?:^'|^"|'$|"$)*/g,""):(1<(u=h.split("../")).length&&(h=u.pop(),x=u.length),f=h.split(".")),c[E[1]?E[0]:""+v]=[h,x,g,f];else f=(o=(u=o.split("../")).pop()).split(".");return i=o===y.recursion,R.push(p&&(d.partials[o]||i)?[d.partials[o],c,p,a,i,w,l]:[o,n,w,a,w,u.length,l,f]),y.splitter}).split(y.splitter),function(t){for(var e,r,n,i,s,a=0,p=l.length,o="";a<p;a++)if(o+=l[a],R[a]!==w){if(r=(s=R[a])[0],!0===s[2]){for(var u in t.data=JSON.parse(JSON.stringify(t.data)),s[1])n=s[1][u],t.data[u]=n[2]?n[0]:P(t,n[0],n[3],n[1]);e=(r||d.partials[y.recursion])(b(t.data,t.extra))}else e=P(t,r,s[7],s[5]),e=(i=!s[6]&&y.helpers[r]||E(e)&&e)?i.apply(S(d,t),[].concat(s[1])):r.isExecutor?r(t):e&&(s[3]?e:c(e,d));e!==w&&(o+=e)}return o}}function R(u,l,t,c,f){var h=!1,e=t.split("../"),g=e.pop().replace(/^(?:\.|this)\//,function(){return h=!0,""}),x=e.length,v=g.split(".");return function(t){var e,r=P(t,g,v,x);if(console.log(x,g,":",r),(e=r)&&e.constructor===Array){if(f)return r.length?"":l(r);for(var n=0,i=r.length,s="";n<i;n++){var a={"@index":""+n,"@last":n===i-1,"@first":!n,".":r[n],this:r[n]};t=b(t,t.extra,r[n],a),s+=l(t),t.path.pop()}return s}var p="object"==typeof r?r:t,o=!h&&u.options.helpers[g]||E(r)&&r;return o?o.apply(S(u,t),[l(t)].concat(c.split(/\s+/))):f&&!r||!f&&r?l(b(t,t.extra,p,{".":r,this:r})):void 0}}});