/**! @license schnauzer v1.0.0; Copyright (C) 2017-2018 by Peter Dematté */
!function(t,e){"object"==typeof exports?module.exports=e(t):"function"==typeof define&&define.amd?define("schnauzer",[],function(){return e(t)}):t.Schnauzer=e(t)}(this,function(t,x,d){"use strict";var e=function(t,e){this.version="1.0.0",this.options={tags:["{{","}}"],entityMap:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},doEscape:!0,helpers:{if:function(t,e){return t.split("{{else}}")[this.getData(e).value?0:1]},else:function(){return"{{else}}"},unless:function(t,e){return this.getData(e).value?"":t}},partials:{},recursion:"self",characters:'$"<>%-=@°',splitter:"|##|"},r(this,e||{},t)},r=function(t,e,r){for(var n in e)if("helpers"===n)for(var i in e[n])t.registerHelper(i,e[n][i]);else t.options[n]=e[n];for(var a in d=1,e=t.options,t.entityRegExp=function(t,e){for(var r in t)e+=r;return new RegExp("["+e+"]","g")}(e.entityMap,[]),t.stopRegExp=new RegExp(/^°+/),s(t,e.tags),t.partials={},e.partials)t.registerPartial(a,e.partials[a]);r&&t.registerPartial(e.recursion,r)},E=Array.isArray||function(t){return t&&t.constructor===Array},R=function(t){return t&&"function"==typeof t},m=Object.keys||function(t,e){for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};return e.prototype={render:function(t,e){return this.partials[this.options.recursion](t,e)},parse:function(t){return this.partials[this.options.recursion]||this.registerPartial(this.options.recursion,t)},registerHelper:function(t,e){this.options.helpers[t]=e},unregisterHelper:function(t){delete this.options.helpers[t]},registerPartial:function(t,e){return this.partials[t]=function u(l,t){var c=l.options,h=[],a=[],f=[],g=-1,v="",e=t.replace(l.sectionRegExp,function(t,e,r,n,i,a,s){var p=a+e+r,o=i.lastIndexOf(p);return f.length?t:(g++,-1!==o?(f.push(g--),v=Array(++d).join("°"),p+(n?" "+n:n)+s+i.substring(0,o)+a+e+v+r+i.substring(o+p.length)+a+"/"+v+r+s):("each"!==(r=r.replace(l.stopRegExp,""))&&"with"!==r||(r=r+"°"+n,n=""),h.push(l.partRegExp.test(i)?j(l,u(l,i),r,n,"^"===e):j(l,b(l,i),r,n,"^"===e)),c.splitter))}).split(c.splitter);for(var r=0,n=f.length;r<n;r++)e[f[r]]=u(l,e[f[r]]);for(var r=0,n=e.length;r<n;r++)a.push(R(e[r])?e[r]:b(l,e[r])),h[r]&&a.push(h[r]);return function(t,e){t.__schnauzer&&!e||(t=w(t,e));for(var r=0,n=a.length,i="";r<n;r++)i+=a[r](t)||"";return i}}(this,e)},unregisterPartial:function(t){delete this.options.partials[t]},setTags:function(t){s(this,t)}},e;function s(t,e){var r=t.options.tags="{{"===e[0]?["{{2,3}","}{2,3}"]:e,n=t.options.characters;t.variableRegExp=new RegExp("("+r[0]+")([>!&=]\\s*)*([\\w\\"+n+"\\.\\s*]+)*"+r[1],"g"),t.sectionRegExp=new RegExp(r[0]+"(#|\\^)([\\w"+n+"]*)\\s*(.*?)"+r[1]+"([\\S\\s]*?)("+r[0]+")\\/\\2("+r[1]+")","g"),t.partRegExp=new RegExp(r[0]+"[#^]"),t.escapeRegExp=new RegExp(r[0])}function w(t,e,r,n){return{data:r||t.data||t,extra:[].concat(t.extra||[],e||[]),path:[].concat(t.path!==x?t.path:t,r||[]),helpers:[].concat(t.helpers||[],r&&(n||{})||[]),__schnauzer:!0}}function u(t,e){for(var r=0,n=e.length;r<n;r++)t=t&&t[e[r]];return t}function S(t,e,r,n){var i=t.path.length-1-n,a=t.path[i]||{},s=t.helpers[i-1]||{},p=s[e]!==x?s[e]:u(s,r);if(p===x&&(p=a[e]!==x?a[e]:u(a,r)),p!==x)return p;for(var o=t.extra.length;o--;){if(t.extra[o][e]!==x)return t.extra[o][e];if((p=u(t.extra[o],r))!==x)return p}}function k(t,e){var r=t.split(/\s*=\s*/),n=1<r.length?r[1]:r[0],i='"'===n.charAt(0)||"'"===n.charAt(0),a=0,s=[],p=!1;if(i)n=n.replace(/(?:^['"]|['"]$)/g,"");else{var o=n.split("../");1<o.length&&(n=("@"===o[0]?"@":"")+o.pop(),a=o.length),name=name.replace(/^(?:\.|this)\//,function(){return p=!0,""}),s=n.split(/[\.\/]/)}return{name:1<r.length?r[0]:n,value:i||!e?n:S(e,n,s,a),isString:i,isStrict:p,keys:s,depth:a}}function y(t,e){return String(t).replace(e.entityRegExp,function(t){return e.options.entityMap[t]})}function P(e,r,t){return{getData:function(t){return k(t,r)},escapeHtml:function(t){return y(t,e)}}}function b(h,f){var g=[],v=h.options;return f=f.replace(h.variableRegExp,function(t,e,r,n){var i,a=r&&r.charAt(0)||"",s=">"===a,p="",o=!1,u={};if("!"===a||"="===a)return"";if(p=(n=n.split(/\s+/)).shift(),s)for(var l=n.length,c={};l--;)u[(c=k(n[l])).name]=c;else o=(u=k(p)).isStrict,p=u.name;return i=p===v.recursion,s=s&&(!!h.partials[p]||i),g.push({value:s?h.partials[p]:p,data:s?u:n,isPartial:s,isUnescaped:!v.doEscape||"&"===a||h.escapeRegExp.test(e)&&3===e.length,isSelf:i,depth:s?x:u.depth,isStrict:o,keys:s?x:u.keys}),v.splitter}).split(v.splitter),function(t){for(var e,r,n,i,a,s=0,p=f.length,o="";s<p;s++)if(o+=f[s],g[s]!==x){if(r=(a=g[s]).value,a.isPartial){var u={};for(var l in t.data)u[l]=t.data[l];for(var c in a.data)n=a.data[c],u[c]=n.isString?n.value:S(t,n.value,n.keys,n.depth);e=(r||h.partials[v.recursion])(w(u,t.extra))}else e=S(t,r,a.keys,a.depth),e=(i=!a.isStrict&&v.helpers[r]||R(e)&&e)?i.apply(P(h,t),a.data):R(r)?r(t):e&&(a.isUnescaped?e:y(e,h));e!==x&&(o+=e)}return o}}function A(t,e,r,n){t[e[0]]=n,t[e[1]]=r}function j(h,f,g,v,x){var t=g.match(/^(each|with)°/)||[],d="each"===t[1],y=g.split(/\s+as\s+\|/);return g=y.shift().split(/\s+/)[0],g=k(t[0]?g.replace(t[0],""):g),y=y[0]&&y[0].replace(/\|/g,"").split(/\s+/),function(t){var e=S(t,g.name,g.keys,g.depth),r=E(e),n=!r&&"object"==typeof e,i=d&&n&&e;if(i&&(e=m(e,[])),r||i){if(x)return e.length?"":f(e);for(var a=0,s=e.length,p="";a<s;a++){var o=r?e[a]:i[e[a]],u={"@index":""+a,"@last":a===s-1,"@first":!a,".":o,this:o,"@key":r?a:e[a]};y&&A(u,y,r?a:e[a],o),t=w(t,t.extra,o,u),p+=f(t),t.path.pop(),t.helpers.pop()}return p}var l=n?e:t,c=!g.isStrict&&h.options.helpers[g.name]||R(e)&&e;return c?c.apply(P(h,t),[f(t)].concat(v.split(/\s+/))):x&&!e||!x&&e?(u={".":e,this:e,"@key":g.name},y&&A(u,y,g.name,e),f(w(t,t.extra,l,u))):void 0}}});